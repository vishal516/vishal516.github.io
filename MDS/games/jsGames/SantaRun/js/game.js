"use strict";var gameready=function(){function e(a){window.requestAnimationFrame(e),t(a),n()}function t(e){var t=(e-o)/1e3;o=e,updater(),a(t)}function a(e){.25<l&&(Math.round(r/l),l=0,r=0),l+=e,r++}function n(){renderer(),i()}function i(){context.fillStyle="#000000",context.font="12px Verdana"}var o=0,l=0,r=0,s=[];console.log("assets loaded"),window.addEventListener("keydown",function(t){s[t.keyCode||t.which]=!0},!0),window.addEventListener("keyup",function(t){s[t.keyCode||t.which]=!1},!0),window.addEventListener("keyup",function(t){switch(t.keyCode){case 37:leftkey(),leftkeyPressedGUI();break;case 38:upkey();break;case 39:rightkey(),rightkeyPressedGUI();break;case 40:downkey();break;case 32:spacekeyDebug();break;case 13:enterkeyPressedGUI(),enterkey();}},!1),function(){uiInit(),e(0)}()};var gameobjects={level:{speed:1,speedmax:10,speedmin:1,groundcontainer:[],housecontainer:[],enemycontainer:[],bulletcontainer:[],enemybulletcontainer:[],bombdropcontainer:[],blastcontainer:[],collectablecontainer:[],tile:{ground:{x:0,y:900,yshow:800,width:1e3,height:200,count:3},house:{x:0,y:800,width:500,height:500,count:3}}},enemy:{x:100,y:50,width:50,height:50,count:4},paralax:{x:0,y:150,width:2400,height:750,dir:-1,speed:2},defaults:{warnings:{x:600,y:500,width:600,height:100},scoreunit:20,disableInput:!1,duration:5000,durationmin:0,durationmax:5000,time:5,stopwatch:null,playerHealth:5,ammo:40},player:{x:300,y:750,width:200,height:350,level:1,score:0,highscore:0,lastscore:0,time:0,health:10,ammo:10,speed:2,gravity:1/2,jump:{state:!1,height:9,speedfactor:10},shoot:{state:!1,time:9},animationframe:0,framelength:19,tilex:5e3/19,tiley:271,imgpos:{x:40,y:30,width:100,height:60}},background:{x:0,y:0,width:1600,height:1e3,layer2:{x:0,y:200,width:1600,height:500},layer3:{x:0,y:200,width:1600,height:900}},gamestate:"",states:{loading:"loading",home:"home",play:"play",pause:"pause",overpass:"overpass",overfail:"overfail",info:"info"},images:["images/background.jpg","images/cloud.png","images/Font.png","images/jfont.png","images/gamelogo.png","images/BtnInfoOn.png","images/BtnPlayOn.png","images/BtnSoundOn.png","images/BtnSoundOff.png","images/BtnRestartOn.png","images/BtnExitOn.png","images/Button.png","images/road.png","images/fog.png","images/bg3.png","images/bg2.png","images/house/house10.png","images/house/house20.png","images/house/house30.png","images/house/house40.png","images/house/house50.png","images/house/house11.png","images/house/house21.png","images/house/house31.png","images/house/house41.png","images/house/house51.png","images/Player/santaspritesheet.png","images/Player/santashootss.png","images/Player/santajump.png","images/Player/santathrow.png","images/enemies/deerss.png","images/enemies/snowmanss.png","images/enemies/cookiess.png","images/enemies/elfss.png","images/enemies/bomb.png","images/enemies/smoke.png","images/enemies/cart.png","images/enemies/cart2.png","images/snowball.png","images/ammopickup.png","images/healthpickup.png"],sounds:["media/Button.m4a","media/gamemusic.ogg","media/gameover.ogg","media/ammo.ogg","media/life.ogg","media/jump.ogg","media/shot.ogg","media/hit.ogg","media/hit2.ogg"]},GUI={canvas:{x:0,y:0,width:1600,height:1e3},gamelogo:{x:400,y:150,width:950,height:300},playMenu:{x:0,y:500,width:400,height:400},pauseMenu:{x:0,y:500,width:400,height:400},btnPlay:{x:50,y:50,width:150,height:150},btnSound:{x:50,y:50,width:150,height:150},btnInfo:{x:50,y:50,width:150,height:150},btnCommon:{x:50,y:50,width:150,height:150},levelup:{x:350,y:1100,width:900,height:400},decoration:{bubbles:[],bubblesLength:10},pointerPadding:40},img=loadImages(gameobjects.images),sound=loadSound(gameobjects.sounds),homeScreenButtonList=[img.BtnPlayOn,img.BtnInfoOn,img.BtnSoundOn],pauseScreenButtonList=[img.BtnPlayOn,img.BtnRestartOn,img.BtnExitOn,img.BtnSoundOn],homeScreenPointerPos=0,pauseScreenPointerPos=0,globalsound=!0,loadcount=0,loadtotal=0,preloaded=!1;function loadImages(t){preloaded=!1;for(var a,n=[],o={},l=0;l<t.length;l++)a=new Image,a.src=t[l],a.onload=function(a){loadcount+=1,console.log(a.path[0].outerHTML),loadcount==t.length&&(preloaded=!0)},n[l]=a,o[a.src.split("/")[a.src.split("/").length-1].split(".")[0]]=a;return o}function loadSound(e){for(var t,a=[],n={},o=0;o<e.length;o++)t=new Audio(e[o]),a[o]=t,n[t.src.split("/")[t.src.split("/").length-1].split(".")[0]]=t;return n}function handleGlobalSound(){globalsound=!globalsound,globalsound?sound.gamemusic.play():(sound.gamemusic.pause(),sound.gamemusic.currentTime=0),Object.keys(sound).forEach(function(e){sound[e].volume=globalsound?1:0})}function raindrop(){this.x=random(GUI.canvas.width+100,GUI.canvas.width+1100),this.y=randomFloat(0,GUI.canvas.height/4),this.size=random(100,200),this.width=this.size,this.height=2*this.size/3,this.image=img.cloud;var e=this;createjs.Tween.get(e).wait(random(0,9000)).play(createjs.Tween.get(e,{paused:!0,loop:!0}).to({x:-300},5000).to({x:GUI.canvas.width+100},0))}function raindropeffect(){for(var e=0;e<GUI.decoration.bubblesLength;e++)GUI.decoration.bubbles.push(new raindrop)}function houseConstructor(){this.x=500,this.type=random(1,5);var e=this;this.width=function(){return 1==e.type?400:2==e.type?800:3==e.type?920:4==e.type?600:5==e.type?480:void 0}(),this.height=function(){return 1==e.type?400:2==e.type?800:3==e.type?920:4==e.type?600:5==e.type?640:void 0}(),this.img=img["house"+this.type+random(0,1)],this.y=gameobjects.level.tile.ground.yshow-this.height}function enemyConstructor(){this.type=random(2,6),this.damageplayer=!0,this.damageble=!0;var e=this;this.width=function(){return 1==e.type?250:2==e.type?120:3==e.type?200:4==e.type?200:5==e.type?200:6==e.type?250:void 0}(),this.height=function(){return 1==e.type?140:2==e.type?200:3==e.type?300:4==e.type?300:5==e.type?300:6==e.type?350:void 0}(),this.img=function(){if(1==e.type)return["death"];if(2==e.type)return e.damageble=!1,{img:function(){return["cart","cart2"][random(0,1)]}(),animationframe:0,totalframes:1,tilex:496,tiley:420,x:0,y:30,width:100,height:50};return 3==e.type?{img:"snowmanss",animationframe:0,totalframes:22,tilex:4999/22,tiley:253,x:50,y:30,width:70,height:50}:4==e.type?{img:"cookiess",animationframe:0,totalframes:22,tilex:4999/22,tiley:269,x:50,y:30,width:70,height:50}:5==e.type?{img:"elfss",animationframe:0,totalframes:22,tilex:4999/22,tiley:272,x:50,y:30,width:70,height:50}:6==e.type?{img:"deerss",animationframe:0,totalframes:22,tilex:4999/22,tiley:212,x:250,y:80,width:350,height:100}:void 0}(),this.x=function(){for(var e,t=0,a=0;a<gameobjects.level.enemycontainer.length;a++)e=gameobjects.level.enemycontainer[a].x+gameobjects.level.enemycontainer[a].width,e>t&&(t=e);return t}()+random(GUI.canvas.width/2,GUI.canvas.width),this.y=function(){return 1==e.type?gameobjects.level.tile.ground.y-e.height:2==e.type?gameobjects.level.tile.ground.y-e.height:3==e.type?gameobjects.level.tile.ground.y-e.height:4==e.type?gameobjects.level.tile.ground.y-e.height:5==e.type?gameobjects.level.tile.ground.y-e.height:6==e.type?gameobjects.level.tile.ground.y-e.height:void 0}(),gameobjects.level.tile.ground.y-this.height,this.speed=function(){return 1==e.type?0:2==e.type?0:3==e.type?0:4==e.type?2:5==e.type?2:6==e.type?2:void 0}(),this.health=function(){return 1==e.type?0:2==e.type?0:3==e.type?0:4==e.type?0:5==e.type?0:6==e.type?0:void 0}(),this.attacktime=function(){return 1==e.type?1e3:2==e.type?1e3:3==e.type?220:4==e.type?1e3:5==e.type?1e3:6==e.type?1e3:void 0}(),this.attacktimeinitial=function(){return 1==e.type?1e3:2==e.type?1e3:3==e.type?440:4==e.type?1e3:5==e.type?1e3:6==e.type?1e3:void 0}(),this.fly=function(){return!(-1!=e.type)}()}function bulletConstructor(e,t){this.y=e.y+.4*e.height,this.width=70,this.height=70,this.dir=t*(gameobjects.player.speed+gameobjects.player.level),sound.shot.play(),0>t&&(this.x=e.x+t*e.width/2),0<t&&(this.x=e.x+t*e.width)}function bombdropConstructor(e){this.x=e.x+e.width/2,this.y=e.y+e.height,this.width=50,this.height=50,sound.crow.play()}function blastConstructor(e){var t=1.5*e.height;this.x=e.x,this.y=gameobjects.level.tile.ground.y-t,this.width=t,this.height=t,this.frame=1,this.framemax=10,this.tilex=421,this.tiley=410,sound.hit.play()}function collectableConstructor(e){this.x=e.x,this.y=gameobjects.level.tile.ground.y-130,this.height=130,this.width=130,this.type=random(1,2),this.img=null;var t=this;1==this.type&&(this.img=img.ammopickup),2==this.type&&(this.img=img.healthpickup),this.collect=function(){1==t.type&&(gameobjects.player.ammo+=10,sound.ammo.play()),2==t.type&&(gameobjects.player.health+=2,sound.life.play())}}function updater(){gameobjects.gamestate==gameobjects.states.play&&updatelogic()}function renderer(){renderUI()}function leftkey(){}function rightkey(){gameobjects.gamestate==gameobjects.states.play&&firebullet()}function downkey(){gameobjects.gamestate==gameobjects.states.play}function upkey(){gameobjects.gamestate==gameobjects.states.play&&jump()}function enterkey(){}function spacekeyDebug(){gameobjects.player.level+=1}function reset(){gameobjects.player.score=0,gameobjects.player.level=10,gameobjects.player.ammo=gameobjects.defaults.ammo,gameobjects.level.blastcontainer=[],gameobjects.level.bombdropcontainer=[],gameobjects.level.bulletcontainer=[],gameobjects.level.enemycontainer=[],gameobjects.level.collectablecontainer=[],gameobjects.level.enemycontainer=[],gameobjects.player.health=gameobjects.defaults.playerHealth}function playerdamage(){1<gameobjects.player.health?(gameobjects.player.health-=1,sound.hit2.play()):gameover()}function startgame(){gameobjects.gamestate=gameobjects.states.play}function gameover(){gameobjects.gamestate=gameobjects.states.overfail,sound.gameover.play(),scoremanager()}function startnewgame(){reset(),startgame()}function scoremanager(){gameobjects.player.lastscore=gameobjects.player.score,gameobjects.player.highscore<gameobjects.player.score&&(gameobjects.player.highscore=gameobjects.player.score)}function addscore(){gameobjects.player.score+=gameobjects.defaults.scoreunit,20>gameobjects.player.level&&(gameobjects.player.level+=.1)}function startlogic(){(function(){for(var e,t=0;t<gameobjects.level.tile.ground.count;t++)e=Object.create(gameobjects.level.tile.ground),e.x=gameobjects.level.tile.ground.width*t,gameobjects.level.groundcontainer.push(e)})(),function(){for(var e,t=0;t<gameobjects.level.tile.house.count;t++)e=new houseConstructor,e.x=0<t?900*t:0,gameobjects.level.housecontainer.push(e)}()}function updatelogic(){var e=gameobjects.player.speed+gameobjects.player.level;gameobjects.background.layer3.x>-1600+e?gameobjects.background.layer3.x-=e:gameobjects.background.layer3.x=0,function(){var e=gameobjects.level.tile.ground.y-gameobjects.player.height;gameobjects.player.jump.state&&(gameobjects.player.y-=gameobjects.player.jump.speedfactor*Math.abs(gameobjects.player.jump.speedfactor),gameobjects.player.jump.speedfactor-=gameobjects.player.gravity,gameobjects.player.y+gameobjects.player.height>=gameobjects.level.tile.ground.y&&(gameobjects.player.jump.state=!1)),gameobjects.player.y>e&&(gameobjects.player.y=e)}(),function(){for(var a=gameobjects.level.groundcontainer.length,n=0;n<a;n++)if(gameobjects.level.groundcontainer[n].x<-gameobjects.level.tile.ground.width){var o=gameobjects.level.groundcontainer[n];gameobjects.level.groundcontainer.splice(n,1),gameobjects.level.groundcontainer.push(o),gameobjects.level.groundcontainer[a-1].x=gameobjects.level.groundcontainer[a-2].x+gameobjects.level.tile.ground.width}for(var t=0;t<gameobjects.level.tile.ground.count;t++)gameobjects.level.groundcontainer[t].x-=e}(),function(){for(var a=gameobjects.level.housecontainer.length,n=0;n<a;n++)if(-900>gameobjects.level.housecontainer[n].x){var o=new houseConstructor;gameobjects.level.housecontainer.splice(n,1),gameobjects.level.housecontainer.push(o),o.x=gameobjects.level.housecontainer[gameobjects.level.housecontainer.length-2].x+1e3,1==random(1,10)&&gameobjects.level.collectablecontainer.push(new collectableConstructor(o))}for(var t=0;t<a;t++)gameobjects.level.housecontainer[t].x-=e}(),function(){enemeyGenerator();for(var t=0;t<gameobjects.level.enemycontainer.length;t++)-300>gameobjects.level.enemycontainer[t].x?gameobjects.level.enemycontainer.splice(t,1):checkIntersection(gameobjects.player,gameobjects.level.enemycontainer[t])&&(gameobjects.level.enemycontainer[t].fly||gameobjects.level.blastcontainer.push(new blastConstructor(gameobjects.level.enemycontainer[t])),gameobjects.level.enemycontainer.splice(t,1),playerdamage());for(var a=0;a<gameobjects.level.enemycontainer.length;a++){gameobjects.level.enemycontainer[a].x-=gameobjects.level.enemycontainer[a].speed+e;var n=gameobjects.level.enemycontainer[a];3==n.type&&19==n.img.animationframe&&n.x<GUI.canvas.width&&gameobjects.level.enemybulletcontainer.push(new bulletConstructor(n,-2))}}(),function(){for(var t=0;t<gameobjects.level.bulletcontainer.length;t++){if(gameobjects.level.bulletcontainer[t].x+=gameobjects.level.bulletcontainer[t].dir,gameobjects.level.bulletcontainer[t].x>GUI.canvas.width+100)return void gameobjects.level.bulletcontainer.splice(t,1);for(var a=0;a<gameobjects.level.enemycontainer.length;a++)if(gameobjects.level.enemycontainer[a].damageble&&checkIntersection(gameobjects.level.bulletcontainer[t],gameobjects.level.enemycontainer[a])){addscore(),gameobjects.level.enemycontainer[t].fly||gameobjects.level.blastcontainer.push(new blastConstructor(gameobjects.level.enemycontainer[a])),gameobjects.level.bulletcontainer.splice(t,1),1>gameobjects.level.enemycontainer[a].health?(1==random(1,5)&&gameobjects.level.collectablecontainer.push(new collectableConstructor(gameobjects.level.enemycontainer[a])),gameobjects.level.enemycontainer.splice(a,1)):gameobjects.level.enemycontainer[a].health-=1;break}}for(var n=0;n<gameobjects.level.enemybulletcontainer.length;n++)gameobjects.level.enemybulletcontainer[n].x+=gameobjects.level.enemybulletcontainer[n].dir,checkIntersection(gameobjects.level.enemybulletcontainer[n],gameobjects.player)&&(gameobjects.level.enemybulletcontainer.splice(n,1),playerdamage(),gameobjects.level.blastcontainer.push(new blastConstructor(gameobjects.player)));for(var o,l=0;l<gameobjects.level.bombdropcontainer.length;l++)if(o=gameobjects.level.bombdropcontainer[l],o.y>gameobjects.level.tile.ground.y-o.height){var r={x:o.x-150,y:o.y,width:300,height:300};gameobjects.level.blastcontainer.push(new blastConstructor(r)),gameobjects.level.bombdropcontainer.splice(l,1)}else if(checkIntersection(o,gameobjects.player)){var r={x:o.x-150,y:o.y,width:200,height:200};gameobjects.level.blastcontainer.push(new blastConstructor(r)),gameobjects.level.bombdropcontainer.splice(l,1),playerdamage()}else gameobjects.level.bombdropcontainer[l].x-=e,gameobjects.level.bombdropcontainer[l].y+=.8*e;for(var s=0;s<gameobjects.level.blastcontainer.length;s++)gameobjects.level.blastcontainer[s].x-=e;for(var o,d=0;d<gameobjects.level.collectablecontainer.length;d++)o=gameobjects.level.collectablecontainer[d],o.x>-o.width&&(o.x-=e),checkIntersection(o,gameobjects.player)&&(o.collect(),gameobjects.level.collectablecontainer.splice(d,1))}()}function enemeyGenerator(){for(var e=0;e<gameobjects.enemy.count;e++)gameobjects.level.enemycontainer[e]||(gameobjects.level.enemycontainer[e]=new enemyConstructor)}function firebullet(){0<gameobjects.player.ammo?(gameobjects.player.shoot.state=!0,gameobjects.player.animationframe=10,setTimeout(function(){gameobjects.level.bulletcontainer.push(new bulletConstructor(gameobjects.player,1))},200),gameobjects.player.ammo-=1):sound.noammo.play()}function jump(){gameobjects.player.jump.state||(gameobjects.player.jump.state=!0,gameobjects.player.jump.speedfactor=gameobjects.player.jump.height,sound.jump.play())}function enemyattack(e){e.attacktime=e.attacktimeinitial,e.x<GUI.canvas.width&&(3==e.type&&gameobjects.level.enemybulletcontainer.push(new bulletConstructor(e,-2)),-2==e.type&&gameobjects.level.bombdropcontainer.push(new bombdropConstructor(e,1)))}function renderGame(){for(var e,t=0;t<gameobjects.level.groundcontainer.length;t++)e=gameobjects.level.groundcontainer[t],context.drawImage(img.road,e.x,e.yshow,e.width,e.height);for(var e,a=0;a<gameobjects.level.housecontainer.length;a++)e=gameobjects.level.housecontainer[a],context.drawImage(e.img,e.x,e.y,e.width,e.height);context.drawImage(img.fog,gameobjects.background.layer3.x,gameobjects.background.y,gameobjects.background.layer3.width,gameobjects.background.height),context.drawImage(img.fog,gameobjects.background.layer3.x+gameobjects.background.layer3.width,gameobjects.background.y,gameobjects.background.layer3.width,gameobjects.background.height),function(){gameobjects.player.animationframe+=.5,gameobjects.player.animationframe>gameobjects.player.framelength-1&&(gameobjects.player.animationframe=0);var e=Math.floor(gameobjects.player.animationframe);!0==gameobjects.player.shoot.state?(context.drawImage(img.santashootss,gameobjects.player.tilex*e,0,gameobjects.player.tilex,gameobjects.player.tiley,gameobjects.player.x-gameobjects.player.imgpos.x,gameobjects.player.y-gameobjects.player.imgpos.y,gameobjects.player.width+gameobjects.player.imgpos.width,gameobjects.player.height+gameobjects.player.imgpos.height),16<gameobjects.player.animationframe&&(gameobjects.player.shoot.state=!1)):gameobjects.player.jump.state?context.drawImage(img.santajump,gameobjects.player.x-gameobjects.player.imgpos.x,gameobjects.player.y,gameobjects.player.width+gameobjects.player.imgpos.width,gameobjects.player.height+gameobjects.player.imgpos.height):context.drawImage(img.santaspritesheet,gameobjects.player.tilex*e,0,gameobjects.player.tilex,gameobjects.player.tiley,gameobjects.player.x-gameobjects.player.imgpos.x,gameobjects.player.y-gameobjects.player.imgpos.y,gameobjects.player.width+gameobjects.player.imgpos.width,gameobjects.player.height+gameobjects.player.imgpos.height)}();for(var e,n=0;n<gameobjects.level.enemycontainer.length;n++){e=gameobjects.level.enemycontainer[n],e.img.animationframe+=.5,e.img.animationframe>=e.img.totalframes-1&&(e.img.animationframe=0);var o=Math.floor(e.img.animationframe),l=img[e.img.img];context.drawImage(l,e.img.tilex*o,0,e.img.tilex,e.img.tiley,e.x-e.img.x,e.y-e.img.y,e.width+e.img.width,e.height+e.img.height)}for(var e,r=0;r<gameobjects.level.bulletcontainer.length;r++)e=gameobjects.level.bulletcontainer[r],context.drawImage(img.snowball,e.x,e.y,e.width,e.height);for(var e,s=0;s<gameobjects.level.enemybulletcontainer.length;s++)e=gameobjects.level.enemybulletcontainer[s],context.drawImage(img.snowball,e.x,e.y,e.width,e.height);for(var e,d=0;d<gameobjects.level.bombdropcontainer.length;d++)e=gameobjects.level.bombdropcontainer[d],context.drawImage(img.bomb,e.x,e.y,e.width,e.height);for(var e,p=0;p<gameobjects.level.blastcontainer.length;p++)e=gameobjects.level.blastcontainer[p],context.drawImage(img.smoke,e.tilex*Math.floor(e.frame),0,e.tilex,e.tiley,e.x,e.y,e.width,e.height),e.frame<=e.framemax?gameobjects.level.blastcontainer[p].frame+=.5:gameobjects.level.blastcontainer.splice(p,1);for(var e,g=0;g<gameobjects.level.collectablecontainer.length;g++)e=gameobjects.level.collectablecontainer[g],context.drawImage(e.img,e.x,e.y,e.width,e.height)}var spacing=.5;function renderUI(){gameobjects.background.x>-gameobjects.background.width?gameobjects.background.x-=gameobjects.paralax.speed:gameobjects.background.x+=gameobjects.background.width,gameobjects.background.layer2.x>-gameobjects.background.layer2.width?gameobjects.background.layer2.x-=gameobjects.paralax.speed:gameobjects.background.layer2.x+=gameobjects.background.layer2.width,context.drawImage(img.background,gameobjects.background.x,gameobjects.background.y,gameobjects.background.width,gameobjects.background.height),context.drawImage(img.background,gameobjects.background.x+gameobjects.background.width,gameobjects.background.y,gameobjects.background.width,gameobjects.background.height),context.drawImage(img.bg2,gameobjects.background.layer2.x,gameobjects.background.layer2.y,gameobjects.background.layer2.width,gameobjects.background.layer2.height),context.drawImage(img.bg2,gameobjects.background.layer2.x+gameobjects.background.layer2.width,gameobjects.background.layer2.y,gameobjects.background.layer2.width,gameobjects.background.layer2.height),context.drawImage(img.bg3,gameobjects.background.layer3.x,gameobjects.background.layer3.y,gameobjects.background.layer3.width,gameobjects.background.layer3.height),context.drawImage(img.bg3,gameobjects.background.layer3.x+gameobjects.background.layer3.width,gameobjects.background.layer3.y,gameobjects.background.layer3.width,gameobjects.background.layer3.height);for(var e=GUI.decoration.bubbles,t=0;t<e.length;t++)context.drawImage(e[t].image,e[t].x,e[t].y,e[t].width,e[t].height);if(gameobjects.gamestate==gameobjects.states.loading)spritefont(spritefont2,"LOADING IS COMPLETE",60,spacing,780,400,!0),spritefont(spritefont2,"PRESS OK BUTTON",80,spacing,780,500,!0);else if(gameobjects.gamestate==gameobjects.states.home){spritefont(spritefont2,"SANTA",GUI.gamelogo.height,spacing,800,GUI.gamelogo.y-100,!0),spritefont(spritefont2,"RUN",GUI.gamelogo.height-50,spacing,800,GUI.gamelogo.y+100,!0),context.drawImage(img.Button,GUI.playMenu.x-GUI.pointerPadding/2+GUI.btnCommon.x+200*homeScreenPointerPos,GUI.playMenu.y-GUI.pointerPadding/2+GUI.btnPlay.y,GUI.btnCommon.width+GUI.pointerPadding,GUI.btnCommon.height+GUI.pointerPadding);for(var t=0;t<homeScreenButtonList.length;t++)context.drawImage(homeScreenButtonList[t],GUI.playMenu.x+GUI.btnCommon.x+200*t,GUI.playMenu.y+GUI.btnCommon.y,GUI.btnCommon.width,GUI.btnCommon.height)}else if(gameobjects.gamestate==gameobjects.states.pause){renderGame(),spritefont(spritefont2,"PAUSED",200,spacing,800,100,!0),context.drawImage(img.Button,GUI.pauseMenu.x-GUI.pointerPadding/2+GUI.btnCommon.x+200*pauseScreenPointerPos,GUI.pauseMenu.y-GUI.pointerPadding/2+GUI.btnPlay.y,GUI.btnCommon.width+GUI.pointerPadding,GUI.btnCommon.height+GUI.pointerPadding);for(var t=0;t<pauseScreenButtonList.length;t++)context.drawImage(pauseScreenButtonList[t],GUI.pauseMenu.x+GUI.btnCommon.x+200*t,GUI.pauseMenu.y+GUI.btnCommon.y,GUI.btnCommon.width,GUI.btnCommon.height)}else gameobjects.gamestate==gameobjects.states.play?(renderGame(),spritefont(spritefont2,"SCORE:"+gameobjects.player.score+"  ICE:"+gameobjects.player.ammo+"  HEALTH:"+gameobjects.player.health,60,spacing,800,100,!0)):gameobjects.gamestate==gameobjects.states.overfail?(spritefont(spritefont2,"GAME OVER",200,spacing,800,100,!0),spritefont(spritefont2,"HIGH SCORE:"+gameobjects.player.highscore,60,spacing,800,300,!0),spritefont(spritefont2,"YOUR SCORE:"+gameobjects.player.lastscore,60,spacing,800,400,!0),spritefont(spritefont2,"PRESS OK BUTTON TO GO BACK TO MAIN MENU",40,spacing,800,800,!0)):gameobjects.gamestate==gameobjects.states.info&&(spritefont(spritefont2,"CONTROLS",100,spacing,800,50,!0),spritefont(spritefont2,"PRESS UP BUTTON TO JUMP",60,spacing,800,150,!0),spritefont(spritefont2,"PRESS RIGHT BUTTON TO SHOOT",60,spacing,800,200,!0),spritefont(spritefont2,"PRESS OK BUTTON TO PAUSE/RESUME THE GAME",60,spacing,800,250,!0),spritefont(spritefont2,"HOW TO PLAY",100,spacing,800,350,!0),spritefont(spritefont2,"JUMP OVER TO AVOID OBSTACLES         ",60,spacing,800,450,!0),context.drawImage(img.cart,1100,430,100,100),context.drawImage(img.cart2,1250,430,100,100),spritefont(spritefont2,"SHOOT ICE OR DODGE ENEMIES                       ",60,spacing,800,560,!0),context.drawImage(img.snowmanss,0,0,200,150,820,530,100,100),context.drawImage(img.elfss,0,0,200,120,930,530,100,100),context.drawImage(img.deerss,0,0,200,120,990,530,150,100),context.drawImage(img.cookiess,0,0,200,120,1100,530,150,100),spritefont(spritefont2,"PICK COLLECTABLES       TO GAIN ICE AND HEALTH",60,spacing,800,670,!0),context.drawImage(img.ammopickup,660,660,70,70),context.drawImage(img.healthpickup,740,660,70,70),spritefont(spritefont2,"PRESS OK BUTTON TO GO BACK TO MAIN MENU",40,spacing,800,800,!0))}var lastgamestate="home";window.addEventListener("blur",function(){lastgamestate=gameobjects.gamestate,gameobjects.gamestate=gameobjects.states.pause,sound.gamemusic.pause()}),window.addEventListener("focus",function(){gameobjects.gamestate=lastgamestate,sound.gamemusic.play()}),window.onload=function(){resizeCanvas(),setTimeout(function(){canvas.style.display="block",document.getElementById("loader").style.display="none",gameready()},2e3)},window.onresize=function(){resizeCanvas()};var canvas,context;Canvas2D();function Canvas2D(){canvas=document.getElementById("viewport"),context=canvas.getContext("2d")}var level={x:1,y:65,width:canvas.width-2,height:canvas.height-66};function resizeCanvas(){canvas.style.height=window.innerHeight+"px",canvas.style.width=window.innerWidth+"px"}var canvas2d=new Canvas2D;function resizeCanvasKeepAR(){widthToHeight=window.innerWidth/window.innerHeight,widthToHeightIdeal=16/10,state=widthToHeight>widthToHeightIdeal?"wider":"higher",widthToHeight>widthToHeightIdeal?(canvas.style.height=window.innerHeight+"px",canvas.style.width=window.innerHeight*widthToHeightIdeal+"px",canvas.style.marginLeft=(window.innerWidth-window.innerHeight*widthToHeightIdeal)/2+"px",canvas.style.marginTop="0px"):(canvas.style.width=window.innerWidth+"px",canvas.style.height=window.innerWidth/widthToHeightIdeal+"px",canvas.style.marginTop=(window.innerHeight-window.innerWidth/widthToHeightIdeal)/2+"px",canvas.style.marginLeft="0px")}this.createjs=this.createjs||{},createjs.extend=function(e,t){"use strict";function a(){this.constructor=e}return a.prototype=t.prototype,e.prototype=new a},this.createjs=this.createjs||{},createjs.promote=function(t,a){"use strict";var n=t.prototype,i=Object.getPrototypeOf&&Object.getPrototypeOf(n)||n.__proto__;if(i)for(var o in n[(a+="_")+"constructor"]=i.constructor,i)n.hasOwnProperty(o)&&"function"==typeof i[o]&&(n[a+o]=i[o]);return t},this.createjs=this.createjs||{},createjs.deprecate=function(e,t){"use strict";return function(){var a="Deprecated property or method '"+t+"'. See docs for info.";return console&&(console.warn?console.warn(a):console.log(a)),e&&e.apply(this,arguments)}},this.createjs=this.createjs||{},function(){"use strict";function e(e,t,a){this.type=e,this.target=null,this.currentTarget=null,this.eventPhase=0,this.bubbles=!!t,this.cancelable=!!a,this.timeStamp=new Date().getTime(),this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.removed=!1}var t=e.prototype;t.preventDefault=function(){this.defaultPrevented=this.cancelable&&!0},t.stopPropagation=function(){this.propagationStopped=!0},t.stopImmediatePropagation=function(){this.immediatePropagationStopped=this.propagationStopped=!0},t.remove=function(){this.removed=!0},t.clone=function(){return new e(this.type,this.bubbles,this.cancelable)},t.set=function(e){for(var t in e)this[t]=e[t];return this},t.toString=function(){return"[Event (type="+this.type+")]"},createjs.Event=e}(),this.createjs=this.createjs||{},function(){"use strict";function e(){this._listeners=null,this._captureListeners=null}var t=e.prototype;e.initialize=function(e){e.addEventListener=t.addEventListener,e.on=t.on,e.removeEventListener=e.off=t.removeEventListener,e.removeAllEventListeners=t.removeAllEventListeners,e.hasEventListener=t.hasEventListener,e.dispatchEvent=t.dispatchEvent,e._dispatchEvent=t._dispatchEvent,e.willTrigger=t.willTrigger},t.addEventListener=function(t,a,n){var i=n?this._captureListeners=this._captureListeners||{}:this._listeners=this._listeners||{};var o=i[t];return o&&this.removeEventListener(t,a,n),o=i[t],o?o.push(a):i[t]=[a],a},t.on=function(t,n,i,o,l,e){return n.handleEvent&&(i=i||n,n=n.handleEvent),i=i||this,this.addEventListener(t,function(e){n.call(i,e,l),o&&e.remove()},e)},t.removeEventListener=function(t,a,n){var i=n?this._captureListeners:this._listeners;if(i){var o=i[t];if(o)for(var e=0,l=o.length;l>e;e++)if(o[e]==a){1==l?delete i[t]:o.splice(e,1);break}}},t.off=t.removeEventListener,t.removeAllEventListeners=function(e){e?(this._listeners&&delete this._listeners[e],this._captureListeners&&delete this._captureListeners[e]):this._listeners=this._captureListeners=null},t.dispatchEvent=function(e,t,n){if("string"==typeof e){var o=this._listeners;if(!(t||o&&o[e]))return!0;e=new createjs.Event(e,t,n)}else e.target&&e.clone&&(e=e.clone());try{e.target=this}catch(t){}if(e.bubbles&&this.parent){for(var l=this,r=[l];l.parent;)r.push(l=l.parent);var s,d=r.length;for(s=d-1;0<=s&&!e.propagationStopped;s--)r[s]._dispatchEvent(e,1+(0==s));for(s=1;d>s&&!e.propagationStopped;s++)r[s]._dispatchEvent(e,3)}else this._dispatchEvent(e,2);return!e.defaultPrevented},t.hasEventListener=function(e){var t=this._listeners,a=this._captureListeners;return!!(t&&t[e]||a&&a[e])},t.willTrigger=function(e){for(var t=this;t;){if(t.hasEventListener(e))return!0;t=t.parent}return!1},t.toString=function(){return"[EventDispatcher]"},t._dispatchEvent=function(t,a){var n,i,o=2>=a?this._captureListeners:this._listeners;if(t&&o&&(i=o[t.type])&&(n=i.length)){try{t.currentTarget=this}catch(e){}try{t.eventPhase=0|a}catch(e){}t.removed=!1,i=i.slice();for(var e,l=0;n>l&&!t.immediatePropagationStopped;l++)e=i[l],e.handleEvent?e.handleEvent(t):e(t),t.removed&&(this.off(t.type,e,1==a),t.removed=!1)}2===a&&this._dispatchEvent(t,2.1)},createjs.EventDispatcher=e}(),this.createjs=this.createjs||{},function(){"use strict";function t(){throw"Ticker cannot be instantiated."}t.RAF_SYNCHED="synched",t.RAF="raf",t.TIMEOUT="timeout",t.timingMode=null,t.maxDelta=0,t.paused=!1,t.removeEventListener=null,t.removeAllEventListeners=null,t.dispatchEvent=null,t.hasEventListener=null,t._listeners=null,createjs.EventDispatcher.initialize(t),t._addEventListener=t.addEventListener,t.addEventListener=function(){return!t._inited&&t.init(),t._addEventListener.apply(t,arguments)},t._inited=!1,t._startTime=0,t._pausedTime=0,t._ticks=0,t._pausedTicks=0,t._interval=50,t._lastTime=0,t._times=null,t._tickTimes=null,t._timerId=null,t._raf=!0,t._setInterval=function(e){t._interval=e,t._inited&&t._setupTick()},t.setInterval=createjs.deprecate(t._setInterval,"Ticker.setInterval"),t._getInterval=function(){return t._interval},t.getInterval=createjs.deprecate(t._getInterval,"Ticker.getInterval"),t._setFPS=function(e){t._setInterval(1e3/e)},t.setFPS=createjs.deprecate(t._setFPS,"Ticker.setFPS"),t._getFPS=function(){return 1e3/t._interval},t.getFPS=createjs.deprecate(t._getFPS,"Ticker.getFPS");try{Object.defineProperties(t,{interval:{get:t._getInterval,set:t._setInterval},framerate:{get:t._getFPS,set:t._setFPS}})}catch(e){console.log(e)}t.init=function(){t._inited||(t._inited=!0,t._times=[],t._tickTimes=[],t._startTime=t._getTime(),t._times.push(t._lastTime=0),t.interval=t._interval)},t.reset=function(){if(t._raf){var e=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame;e&&e(t._timerId)}else clearTimeout(t._timerId);t.removeAllEventListeners("tick"),t._timerId=t._times=t._tickTimes=null,t._startTime=t._lastTime=t._ticks=t._pausedTime=0,t._inited=!1},t.getMeasuredTickTime=function(e){var n=0,i=t._tickTimes;if(!i||1>i.length)return-1;e=Math.min(i.length,e||0|t._getFPS());for(var o=0;e>o;o++)n+=i[o];return n/e},t.getMeasuredFPS=function(e){var n=t._times;return!n||2>n.length?-1:(e=Math.min(n.length-1,e||0|t._getFPS()),1e3/((n[0]-n[e])/e))},t.getTime=function(e){return t._startTime?t._getTime()-(e?t._pausedTime:0):-1},t.getEventTime=function(e){return t._startTime?(t._lastTime||t._startTime)-(e?t._pausedTime:0):-1},t.getTicks=function(e){return t._ticks-(e?t._pausedTicks:0)},t._handleSynch=function(){t._timerId=null,t._setupTick(),t._getTime()-t._lastTime>=.97*(t._interval-1)&&t._tick()},t._handleRAF=function(){t._timerId=null,t._setupTick(),t._tick()},t._handleTimeout=function(){t._timerId=null,t._setupTick(),t._tick()},t._setupTick=function(){if(null==t._timerId){var e=t.timingMode;if(e==t.RAF_SYNCHED||e==t.RAF){var a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;if(a)return t._timerId=a(e==t.RAF?t._handleRAF:t._handleSynch),void(t._raf=!0)}t._raf=!1,t._timerId=setTimeout(t._handleTimeout,t._interval)}},t._tick=function(){var n=t.paused,a=t._getTime(),i=a-t._lastTime;if(t._lastTime=a,t._ticks++,n&&(t._pausedTicks++,t._pausedTime+=i),t.hasEventListener("tick")){var o=new createjs.Event("tick"),l=t.maxDelta;o.delta=l&&i>l?l:i,o.paused=n,o.time=a,o.runTime=a-t._pausedTime,t.dispatchEvent(o)}for(t._tickTimes.unshift(t._getTime()-a);100<t._tickTimes.length;)t._tickTimes.pop();for(t._times.unshift(a);100<t._times.length;)t._times.pop()};var a=window,e=a.performance.now||a.performance.mozNow||a.performance.msNow||a.performance.oNow||a.performance.webkitNow;t._getTime=function(){return(e&&e.call(a.performance)||new Date().getTime())-t._startTime},createjs.Ticker=t}(),this.createjs=this.createjs||{},function(){"use strict";function e(e){this.EventDispatcher_constructor(),this.ignoreGlobalPause=!1,this.loop=0,this.useTicks=!1,this.reversed=!1,this.bounce=!1,this.timeScale=1,this.duration=0,this.position=0,this.rawPosition=-1,this._paused=!0,this._next=null,this._prev=null,this._parent=null,this._labels=null,this._labelList=null,e&&(this.useTicks=!!e.useTicks,this.ignoreGlobalPause=!!e.ignoreGlobalPause,this.loop=!0===e.loop?-1:e.loop||0,this.reversed=!!e.reversed,this.bounce=!!e.bounce,this.timeScale=e.timeScale||1,e.onChange&&this.addEventListener("change",e.onChange),e.onComplete&&this.addEventListener("complete",e.onComplete))}var t=createjs.extend(e,createjs.EventDispatcher);t._setPaused=function(e){return createjs.Tween._register(this,e),this},t.setPaused=createjs.deprecate(t._setPaused,"AbstractTween.setPaused"),t._getPaused=function(){return this._paused},t.getPaused=createjs.deprecate(t._getPaused,"AbstactTween.getPaused"),t._getCurrentLabel=function(e){var t=this.getLabels();null==e&&(e=this.position);for(var n=0,i=t.length;i>n&&!(e<t[n].position);n++);return 0==n?null:t[n-1].label},t.getCurrentLabel=createjs.deprecate(t._getCurrentLabel,"AbstractTween.getCurrentLabel");try{Object.defineProperties(t,{paused:{set:t._setPaused,get:t._getPaused},currentLabel:{get:t._getCurrentLabel}})}catch(e){}t.advance=function(e,t){this.setPosition(this.rawPosition+e*this.timeScale,t)},t.setPosition=function(t,n,o,l){var r=this.duration,e=this.loop,s=this.rawPosition,d=0,p=0,g=!1;if(!(0>t&&(t=0),0===r)){if(d=0|t/r,p=t-d*r,g=-1!==e&&t>=e*r+r,g&&(t=(p=r)*(d=e)+r),t===s)return g;var u=!this.reversed!=!(this.bounce&&d%2);u&&(p=r-p)}else if(g=!0,-1!==s)return g;this.position=p,this.rawPosition=t,this._updatePosition(o,g),g&&(this.paused=!0),l&&l(this),n||this._runActions(s,t,o,!o&&-1===s),this.dispatchEvent("change"),g&&this.dispatchEvent("complete")},t.calculatePosition=function(t){var a=this.duration,n=this.loop,i=0,o=0;if(0===a)return 0;-1!==n&&t>=n*a+a?(o=a,i=n):0>t?o=0:(i=0|t/a,o=t-i*a);var l=!this.reversed!=!(this.bounce&&i%2);return l?a-o:o},t.getLabels=function(){var e=this._labelList;if(!e){e=this._labelList=[];var t=this._labels;for(var n in t)e.push({label:n,position:t[n]});e.sort(function(e,t){return e.position-t.position})}return e},t.setLabels=function(e){this._labels=e,this._labelList=null},t.addLabel=function(t,a){this._labels||(this._labels={}),this._labels[t]=a;var n=this._labelList;if(n){for(var i=0,o=n.length;o>i&&!(a<n[i].position);i++);n.splice(i,0,{label:t,position:a})}},t.gotoAndPlay=function(e){this.paused=!1,this._goto(e)},t.gotoAndStop=function(e){this.paused=!0,this._goto(e)},t.resolve=function(e){var t=+e;return isNaN(t)&&(t=this._labels&&this._labels[e]),t},t.toString=function(){return"[AbstractTween]"},t.clone=function(){throw"AbstractTween can not be cloned."},t._init=function(e){e&&e.paused||(this.paused=!1),e&&null!=e.position&&this.setPosition(e.position)},t._updatePosition=function(){},t._goto=function(e){var t=this.resolve(e);null!=t&&this.setPosition(t,!1,!0)},t._runActions=function(t,a,r,s){if(this._actionHead||this.tweens){var u,c,y,_,v=this.duration,i=this.reversed,b=this.bounce,w=this.loop;if(0===v?(u=c=y=_=0,i=b=!1):(u=0|t/v,c=0|a/v,y=t-u*v,_=a-c*v),-1!==w&&(c>w&&(_=v,c=w),u>w&&(y=v,u=w)),r)return this._runActionsRange(_,_,r,s);if(u!==c||y!==_||r||s){-1===u&&(u=y=0);var l=a>=t,m=u;do{var x=!i!=!(b&&m%2),o=m===u?y:l?0:v,T=m===c?_:l?v:0;if(x&&(o=v-o,T=v-T),b&&m!==u&&o===T);else if(this._runActionsRange(o,T,r,s||m!==u&&!b))return!0;s=!1}while(l&&++m<=c||!l&&--m>=c)}}},t._runActionsRange=function(){},createjs.AbstractTween=createjs.promote(e,"EventDispatcher")}(),this.createjs=this.createjs||{},function(){"use strict";function t(e,a){this.AbstractTween_constructor(a),this.pluginData=null,this.target=e,this.passive=!1,this._stepHead=new n(null,0,0,{},null,!0),this._stepTail=this._stepHead,this._stepPosition=0,this._actionHead=null,this._actionTail=null,this._plugins=null,this._pluginIds=null,this._injected=null,a&&(this.pluginData=a.pluginData,a.override&&t.removeTweens(e)),this.pluginData||(this.pluginData={}),this._init(a)}function n(t,a,n,i,o,e){this.next=null,this.prev=t,this.t=a,this.d=n,this.props=i,this.ease=o,this.passive=e,this.index=t?t.index+1:0}function i(t,a,n,i,o){this.next=null,this.prev=t,this.t=a,this.d=0,this.scope=n,this.funct=i,this.params=o}var e=createjs.extend(t,createjs.AbstractTween);t.IGNORE={},t._tweens=[],t._plugins=null,t._tweenHead=null,t._tweenTail=null,t.get=function(e,a){return new t(e,a)},t.tick=function(e,a){for(var n,i=t._tweenHead;i;)n=i._next,a&&!i.ignoreGlobalPause||i._paused||i.advance(i.useTicks?1:e),i=n},t.handleEvent=function(e){"tick"===e.type&&this.tick(e.delta,e.paused)},t.removeTweens=function(e){if(e.tweenjs_count){for(var a,n=t._tweenHead;n;)a=n._next,n.target===e&&t._register(n,!0),n=a;e.tweenjs_count=0}},t.removeAllTweens=function(){for(var e,n=t._tweenHead;n;)e=n._next,n._paused=!0,n.target&&(n.target.tweenjs_count=0),n._next=n._prev=null,n=e;t._tweenHead=t._tweenTail=null},t.hasActiveTweens=function(e){return e?!!e.tweenjs_count:!!t._tweenHead},t._installPlugin=function(n){for(var a=n.priority=n.priority||0,i=t._plugins=t._plugins||[],o=0,l=i.length;l>o&&!(a<i[o].priority);o++);i.splice(o,0,n)},t._register=function(n,a){var i=n.target;if(!a&&n._paused){i&&(i.tweenjs_count=i.tweenjs_count?i.tweenjs_count+1:1);var o=t._tweenTail;o?(t._tweenTail=o._next=n,n._prev=o):t._tweenHead=t._tweenTail=n,!t._inited&&createjs.Ticker&&(createjs.Ticker.addEventListener("tick",t),t._inited=!0)}else if(a&&!n._paused){i&&i.tweenjs_count--;var l=n._next,e=n._prev;l?l._prev=e:t._tweenTail=e,e?e._next=l:t._tweenHead=l,n._next=n._prev=null}n._paused=a},e.wait=function(e,t){return 0<e&&this._addStep(+e,this._stepTail.props,null,t),this},e.to=function(e,t,a){(null==t||0>t)&&(t=0);var n=this._addStep(+t,null,a);return this._appendProps(e,n),this},e.label=function(e){return this.addLabel(e,this.duration),this},e.call=function(e,t,a){return this._addAction(a||this.target,e,t||[this])},e.set=function(e,t){return this._addAction(t||this.target,this._set,[e])},e.play=function(e){return this._addAction(e||this,this._set,[{paused:!1}])},e.pause=function(e){return this._addAction(e||this,this._set,[{paused:!0}])},e.w=e.wait,e.t=e.to,e.c=e.call,e.s=e.set,e.toString=function(){return"[Tween]"},e.clone=function(){throw"Tween can not be cloned."},e._addPlugin=function(t){var a=this._pluginIds||(this._pluginIds={}),n=t.ID;if(n&&!a[n]){a[n]=!0;for(var i=this._plugins||(this._plugins=[]),o=t.priority||0,e=0,l=i.length;l>e;e++)if(o<i[e].priority)return void i.splice(e,0,t);i.push(t)}},e._updatePosition=function(t,a){var n=this._stepHead.next,i=this.position,o=this.duration;if(this.target&&n){for(var e=n.next;e&&e.t<=i;)n=n.next,e=n.next;var l=a?0===o?1:i/o:(i-n.t)/n.d;this._updateTargetProps(n,l,a)}this._stepPosition=n?i-n.t:0},e._updateTargetProps=function(o,a,r){if(!(this.passive=!!o.passive)){var s,p,u,c,y=o.prev.props,h=o.props;(c=o.ease)&&(a=c(a,0,1,1));var i=this._plugins;a:for(var _ in y){if(p=y[_],u=h[_],s=p!==u&&"number"==typeof p?p+(u-p)*a:1<=a?u:p,i)for(var v,w=0,x=i.length;x>w;w++){if(v=i[w].change(this,o,_,s,a,r),v===t.IGNORE)continue a;void 0!==v&&(s=v)}this.target[_]=s}}},e._runActionsRange=function(t,a,n,o){var l=t>a,e=l?this._actionTail:this._actionHead,r=a,s=t;l&&(r=t,s=a);for(var d,p=this.position;e;){if(d=e.t,(d===a||d>s&&r>d||o&&d===t)&&(e.funct.apply(e.scope,e.params),p!==this.position))return!0;e=l?e.prev:e.next}},e._appendProps=function(r,a,s){var u,c,y,_,v,b=this._stepHead.props,i=this.target,w=t._plugins,x=a.prev,l=x.props,m=a.props||(a.props=this._cloneProps(l)),n={};for(u in r)if(r.hasOwnProperty(u)&&(n[u]=m[u]=r[u],void 0===b[u])){if(_=void 0,w)for(c=w.length-1;0<=c;c--)if(y=w[c].init(this,u,_),void 0!==y&&(_=y),_===t.IGNORE){delete m[u],delete n[u];break}_!==t.IGNORE&&(void 0===_&&(_=i[u]),l[u]=void 0===_?null:_)}for(u in n){y=r[u];for(var o,T=x;(o=T)&&(T=o.prev);)if(T.props!==o.props){if(void 0!==T.props[u])break;T.props[u]=l[u]}}if(!1!==s&&(w=this._plugins))for(c=w.length-1;0<=c;c--)w[c].step(this,a,n);(v=this._injected)&&(this._injected=null,this._appendProps(v,a,!1))},e._injectProp=function(e,t){var a=this._injected||(this._injected={});a[e]=t},e._addStep=function(t,a,i,o){var e=new n(this._stepTail,this.duration,t,a,i,o||!1);return this.duration+=t,this._stepTail=this._stepTail.next=e},e._addAction=function(t,a,n){var o=new i(this._actionTail,this.duration,t,a,n);return this._actionTail?this._actionTail.next=o:this._actionHead=o,this._actionTail=o,this},e._set=function(e){for(var t in e)this[t]=e[t]},e._cloneProps=function(e){var t={};for(var a in e)t[a]=e[a];return t},createjs.Tween=createjs.promote(t,"AbstractTween")}(),this.createjs=this.createjs||{},function(){"use strict";function e(e){var t,n;e instanceof Array||null==e&&1<arguments.length?(t=e,n=arguments[1],e=arguments[2]):e&&(t=e.tweens,n=e.labels),this.AbstractTween_constructor(e),this.tweens=[],t&&this.addTween.apply(this,t),this.setLabels(n),this._init(e)}var t=createjs.extend(e,createjs.AbstractTween);t.addTween=function(e){e._parent&&e._parent.removeTween(e);var t=arguments.length;if(1<t){for(var a=0;t>a;a++)this.addTween(arguments[a]);return arguments[t-1]}if(0===t)return null;this.tweens.push(e),e._parent=this,e.paused=!0;var n=e.duration;return 0<e.loop&&(n*=e.loop+1),n>this.duration&&(this.duration=n),0<=this.rawPosition&&e.setPosition(this.rawPosition),e},t.removeTween=function(t){var a=arguments.length;if(1<a){for(var n=!0,i=0;a>i;i++)n=n&&this.removeTween(arguments[i]);return n}if(0===a)return!0;for(var o=this.tweens,i=o.length;i--;)if(o[i]===t)return o.splice(i,1),t._parent=null,t.duration>=this.duration&&this.updateDuration(),!0;return!1},t.updateDuration=function(){this.duration=0;for(var e=0,t=this.tweens.length;t>e;e++){var n=this.tweens[e],i=n.duration;0<n.loop&&(i*=n.loop+1),i>this.duration&&(this.duration=i)}},t.toString=function(){return"[Timeline]"},t.clone=function(){throw"Timeline can not be cloned."},t._updatePosition=function(e){for(var t=this.position,a=0,n=this.tweens.length;n>a;a++)this.tweens[a].setPosition(t,!0,e)},t._runActionsRange=function(t,a,n,i){for(var o=this.position,e=0,l=this.tweens.length;l>e;e++)if(this.tweens[e]._runActions(t,a,n,i),o!==this.position)return!0},createjs.Timeline=createjs.promote(e,"AbstractTween")}(),this.createjs=this.createjs||{},function(){"use strict";function e(){throw"Ease cannot be instantiated."}e.linear=function(e){return e},e.none=e.linear,e.get=function(e){return-1>e?e=-1:1<e&&(e=1),function(t){return 0==e?t:0>e?t*(t*-e+1+e):t*((2-t)*e+(1-e))}},e.getPowIn=function(e){return function(t){return Math.pow(t,e)}},e.getPowOut=function(e){return function(t){return 1-Math.pow(1-t,e)}},e.getPowInOut=function(e){return function(t){return 1>(t*=2)?.5*Math.pow(t,e):1-.5*Math.abs(Math.pow(2-t,e))}},e.quadIn=e.getPowIn(2),e.quadOut=e.getPowOut(2),e.quadInOut=e.getPowInOut(2),e.cubicIn=e.getPowIn(3),e.cubicOut=e.getPowOut(3),e.cubicInOut=e.getPowInOut(3),e.quartIn=e.getPowIn(4),e.quartOut=e.getPowOut(4),e.quartInOut=e.getPowInOut(4),e.quintIn=e.getPowIn(5),e.quintOut=e.getPowOut(5),e.quintInOut=e.getPowInOut(5),e.sineIn=function(e){return 1-Math.cos(e*Math.PI/2)},e.sineOut=function(e){return Math.sin(e*Math.PI/2)},e.sineInOut=function(e){return-.5*(Math.cos(Math.PI*e)-1)},e.getBackIn=function(e){return function(t){return t*t*((e+1)*t-e)}},e.backIn=e.getBackIn(1.7),e.getBackOut=function(e){return function(t){return--t*t*((e+1)*t+e)+1}},e.backOut=e.getBackOut(1.7),e.getBackInOut=function(e){return e*=1.525,function(t){return 1>(t*=2)?.5*t*t*((e+1)*t-e):.5*((t-=2)*t*((e+1)*t+e)+2)}},e.backInOut=e.getBackInOut(1.7),e.circIn=function(e){return-(Math.sqrt(1-e*e)-1)},e.circOut=function(e){return Math.sqrt(1- --e*e)},e.circInOut=function(e){return 1>(e*=2)?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},e.bounceIn=function(t){return 1-e.bounceOut(1-t)},e.bounceOut=function(e){return 1/2.75>e?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},e.bounceInOut=function(t){return .5>t?.5*e.bounceIn(2*t):.5*e.bounceOut(2*t-1)+.5},e.getElasticIn=function(t,a){var n=2*Math.PI;return function(i){if(0==i||1==i)return i;var o=a/n*Math.asin(1/t);return-(t*Math.pow(2,10*(i-=1))*Math.sin((i-o)*n/a))}},e.elasticIn=e.getElasticIn(1,.3),e.getElasticOut=function(t,a){var n=2*Math.PI;return function(i){if(0==i||1==i)return i;var o=a/n*Math.asin(1/t);return t*Math.pow(2,-10*i)*Math.sin((i-o)*n/a)+1}},e.elasticOut=e.getElasticOut(1,.3),e.getElasticInOut=function(t,a){var n=2*Math.PI;return function(i){var o=a/n*Math.asin(1/t);return 1>(i*=2)?-.5*t*Math.pow(2,10*(i-=1))*Math.sin((i-o)*n/a):.5*(t*Math.pow(2,-10*(i-=1))*Math.sin((i-o)*n/a))+1}},e.elasticInOut=e.getElasticInOut(1,1.5*.3),createjs.Ease=e}(),this.createjs=this.createjs||{},function(){"use strict";function e(){throw"MotionGuidePlugin cannot be instantiated."}var _=e;_.priority=0,_.ID="MotionGuide",_.install=function(){return createjs.Tween._installPlugin(e),createjs.Tween.IGNORE},_.init=function(e,t){"guide"==t&&e._addPlugin(_)},_.step=function(t,a,n){for(var o in n)if("guide"==o){var e=a.props.guide,r=_._solveGuideData(n.guide,e);e.valid=!r;var s=e.endData;if(t._injectProp("x",s.x),t._injectProp("y",s.y),r||!e.orient)break;var d=void 0===a.prev.props.rotation?t.target.rotation||0:a.prev.props.rotation;if(e.startOffsetRot=d-e.startData.rotation,"fixed"==e.orient)e.endAbsRot=s.rotation+e.startOffsetRot,e.deltaRotation=0;else{var i=void 0===n.rotation?t.target.rotation||0:n.rotation,p=i-e.endData.rotation-e.startOffsetRot,g=p%360;switch(e.endAbsRot=i,e.orient){case"auto":e.deltaRotation=p;break;case"cw":e.deltaRotation=(g+360)%360+360*Math.abs(0|p/360);break;case"ccw":e.deltaRotation=(g-360)%360+-360*Math.abs(0|p/360);}}t._injectProp("rotation",e.endAbsRot)}},_.change=function(t,a,n,i,e){var o=a.props.guide;if(o&&a.props!==a.prev.props&&o!==a.prev.props.guide)return"guide"===n&&!o.valid||"x"==n||"y"==n||"rotation"===n&&o.orient?createjs.Tween.IGNORE:void _._ratioToPositionData(e,o,t.target)},_.debug=function(t,a,n){t=t.guide||t;var i=_._findPathProblems(t);if(i&&console.error("MotionGuidePlugin Error found: \n"+i),!a)return i;var e,o=t.path,r=o.length;for(a.save(),a.lineCap="round",a.lineJoin="miter",a.beginPath(),a.moveTo(o[0],o[1]),e=2;r>e;e+=4)a.quadraticCurveTo(o[e],o[e+1],o[e+2],o[e+3]);a.strokeStyle="black",a.lineWidth=1.5*3,a.stroke(),a.strokeStyle="white",a.lineWidth=3,a.stroke(),a.closePath();var s=n.length;if(n&&s){var d={},l={};_._solveGuideData(t,d);for(var e=0;s>e;e++)d.orient="fixed",_._ratioToPositionData(n[e],d,l),a.beginPath(),a.moveTo(l.x,l.y),a.lineTo(l.x+Math.cos(.0174533*l.rotation)*9,l.y+Math.sin(.0174533*l.rotation)*9),a.strokeStyle="black",a.lineWidth=1.5*3,a.stroke(),a.strokeStyle="red",a.lineWidth=3,a.stroke(),a.closePath()}return a.restore(),i},_._solveGuideData=function(a,p){var c;if(c=_.debug(a))return c;{var b=p.path=a.path;p.orient=a.orient}p.subLines=[],p.totalLength=0,p.startOffsetRot=0,p.deltaRotation=0,p.startData={ratio:0},p.endData={ratio:1},p.animSpan=1;var e,T,P,E,I,O,S,L,A,C=b.length,o={};for(e=b[0],T=b[1],S=2;C>S;S+=4){P=b[S],E=b[S+1],I=b[S+2],O=b[S+3];var R={weightings:[],estLength:0,portion:0},r=e,D=T;for(L=1;10>=L;L++){_._getParamsForCurve(e,T,P,E,I,O,L/10,!1,o);var B=o.x-r,u=o.y-D;A=Math.sqrt(B*B+u*u),R.weightings.push(A),R.estLength+=A,r=o.x,D=o.y}for(p.totalLength+=R.estLength,L=0;10>L;L++)A=R.estLength,R.weightings[L]/=A;p.subLines.push(R),e=I,T=O}A=p.totalLength;var v=p.subLines.length;for(S=0;v>S;S++)p.subLines[S].portion=p.subLines[S].estLength/A;var w=isNaN(a.start)?0:a.start,x=isNaN(a.end)?1:a.end;_._ratioToPositionData(w,p,p.startData),_._ratioToPositionData(x,p,p.endData),p.startData.ratio=w,p.endData.ratio=x,p.animSpan=p.endData.ratio-p.startData.ratio},_._ratioToPositionData=function(t,a,l){var r,s,d,u,c,y=a.subLines,v=0,b=t*a.animSpan+a.startData.ratio;for(s=y.length,r=0;s>r;r++){if(u=y[r].portion,v+u>=b){c=r;break}v+=u}void 0===c&&(c=s-1,v-=u);var m=y[c].weightings,n=u;for(s=m.length,r=0;s>r&&(u=m[r]*n,!(v+u>=b));r++)v+=u;c=4*c+2,d=r/10+(b-v)/u*(1/10);var o=a.path;return _._getParamsForCurve(o[c-2],o[c-1],o[c],o[c+1],o[c+2],o[c+3],d,a.orient,l),a.orient&&(.99999<=t&&1.00001>=t&&void 0!==a.endAbsRot?l.rotation=a.endAbsRot:l.rotation+=a.startOffsetRot+t*a.deltaRotation),l},_._getParamsForCurve=function(t,a,n,o,l,e,r,s,d){var i=1-r;d.x=i*i*t+2*i*r*n+r*r*l,d.y=i*i*a+2*i*r*o+r*r*e,s&&(d.rotation=57.2957795*Math.atan2((o-a)*i+(e-o)*r,(n-t)*i+(l-n)*r))},_._findPathProblems=function(t){var a=t.path,n=a&&a.length||0;if(6>n||(n-2)%4){var i="\tCannot parse 'path' array due to invalid number of entries in path. ";return i+="There should be an odd number of points, at least 3 points, and 2 entries per point (x & y). ",i+="See 'CanvasRenderingContext2D.quadraticCurveTo' for details as 'path' models a quadratic bezier.\n\n",i+="Only [ "+n+" ] values found. Expected: "+Math.max(4*Math.ceil((n-2)/4)+2,6)}for(var o=0;n>o;o++)if(isNaN(a[o]))return"All data in path array must be numeric";var l=t.start;if(isNaN(l)&&void 0!==l)return"'start' out of bounds. Expected 0 to 1, got: "+l;var r=t.end;if(isNaN(r)&&void 0!==r)return"'end' out of bounds. Expected 0 to 1, got: "+r;var s=t.orient;return s&&"fixed"!=s&&"auto"!=s&&"cw"!=s&&"ccw"!=s?"Invalid orientation value. Expected [\"fixed\", \"auto\", \"cw\", \"ccw\", undefined], got: "+s:void 0},createjs.MotionGuidePlugin=e}(),this.createjs=this.createjs||{},function(){"use strict";var e=createjs.TweenJS=createjs.TweenJS||{};e.version="1.0.0",e.buildDate="Thu, 14 Sep 2017 19:47:47 GMT"}();function uiInit(){gameobjects.gamestate=gameobjects.states.loading,createHomeMenu(),raindropeffect(),startlogic()}function createHomeMenu(){createjs.Tween.get(GUI.gamelogo).play(createjs.Tween.get(GUI.gamelogo,{paused:!0,loop:!0}).to({width:GUI.gamelogo.width+20,height:GUI.gamelogo.height+20},500,createjs.Ease.quadOut).to({width:GUI.gamelogo.width,height:GUI.gamelogo.height},500,createjs.Ease.quadOut)),createjs.Tween.get(GUI.gamelogo).play(createjs.Tween.get(GUI.gamelogo,{paused:!0,loop:!0}).to({x:GUI.gamelogo.x-10},500,createjs.Ease.quadOut).to({x:GUI.gamelogo.x},500,createjs.Ease.quadOut)),function(){GUI.playMenu.width=GUI.btnCommon.width*(homeScreenButtonList.length+1),GUI.playMenu.x=(canvas.width-GUI.playMenu.width)/2-8*homeScreenButtonList.length,GUI.pauseMenu.width=GUI.btnCommon.width*(pauseScreenButtonList.length+1),GUI.pauseMenu.x=(canvas.width-GUI.pauseMenu.width)/2-8*pauseScreenButtonList.length}(),createjs.Tween.get(GUI.btnCommon).play(createjs.Tween.get(GUI.btnCommon,{paused:!0,loop:!0}).to({height:GUI.btnCommon.height+5},500,createjs.Ease.quadOut).to({height:GUI.btnCommon.height},500,createjs.Ease.quadOut)),GUI.levelup.y=-400}function leftkeyPressedGUI(){gameobjects.gamestate==gameobjects.states.home&&(homeScreenPointerPos=movePointer(homeScreenPointerPos,homeScreenButtonList,!1)),gameobjects.gamestate==gameobjects.states.pause&&(pauseScreenPointerPos=movePointer(pauseScreenPointerPos,pauseScreenButtonList,!1))}function rightkeyPressedGUI(){gameobjects.gamestate==gameobjects.states.home&&(homeScreenPointerPos=movePointer(homeScreenPointerPos,homeScreenButtonList,!0)),gameobjects.gamestate==gameobjects.states.pause&&(pauseScreenPointerPos=movePointer(pauseScreenPointerPos,pauseScreenButtonList,!0))}function enterkeyPressedGUI(){sound.Button.play(),gameobjects.gamestate==gameobjects.states.loading&&(setTimeout(function(){gameobjects.gamestate=gameobjects.states.home},10),GUI.loading=!1,sound.gamemusic.loop=!0,sound.gamemusic.play()),gameobjects.gamestate==gameobjects.states.home?(0==homeScreenPointerPos&&(gameobjects.gamestate=gameobjects.states.play,startnewgame()),1==homeScreenPointerPos&&(gameobjects.gamestate=gameobjects.states.info,console.log("info")),2==homeScreenPointerPos&&(console.log("audio"),handleGlobalSound(),homeScreenButtonList[2]=globalsound?img.BtnSoundOn:img.BtnSoundOff,pauseScreenButtonList[3]=globalsound?img.BtnSoundOn:img.BtnSoundOff)):gameobjects.gamestate==gameobjects.states.info?gameobjects.gamestate=gameobjects.states.home:gameobjects.gamestate==gameobjects.states.play?(gameobjects.gamestate=gameobjects.states.pause,console.log("paused")):gameobjects.gamestate==gameobjects.states.pause?(0==pauseScreenPointerPos&&(gameobjects.gamestate=gameobjects.states.play),1==pauseScreenPointerPos&&(startnewgame(),gameobjects.gamestate=gameobjects.states.play),2==pauseScreenPointerPos&&(gameobjects.gamestate=gameobjects.states.home),3==pauseScreenPointerPos&&(console.log("audio"),handleGlobalSound(),homeScreenButtonList[2]=globalsound?img.BtnSoundOn:img.BtnSoundOff,pauseScreenButtonList[3]=globalsound?img.BtnSoundOn:img.BtnSoundOff)):gameobjects.gamestate==gameobjects.states.overpass?gameobjects.gamestate=gameobjects.states.play:gameobjects.gamestate==gameobjects.states.overfail&&(gameobjects.gamestate=gameobjects.states.home)}function downkeyPressedGUI(){}function upkeyPressedGUI(){}function movePointer(e,t,a){return a?e+1>=t.length?0:e+1:0>e-1?t.length-1:e-1}"use strict",String.prototype.toHHMMSS=function(){var e=parseInt(this,10),t=Math.floor(e/3600),a=Math.floor((e-3600*t)/60),n=e-3600*t-60*a;return 10>t&&(t="0"+t),10>a&&(a="0"+a),10>n&&(n="0"+n),t+":"+a+":"+n};function characterIndex(e,t){for(var n=0;n<t.xindex;n++)for(var i,o=0;o<t.yindex;o++)if(i=t.characterSet[o*t.xindex+n],t.lowercase){if(e==i){var l={i:n,j:o};return l}}else if(e.toLowerCase()==i.toLowerCase()){var l={i:n,j:o};return l}}function spritefont(e,t,a,n,o,l,r){r&&(o-=(t.length+1)*a*n/2);for(var s=e.imgResolutionx/e.xindex,d=e.imgResolutiony/e.yindex,p=0;p<t.length;p++)if(" "!=t[p]){var g=characterIndex(t[p],e).i,i=characterIndex(t[p],e).j;context.drawImage(img[e.img],s*g,d*i,s,d,o+a*n*p,l,a,a)}}var spritefont2={characterSet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789:/",lowercase:!0,xindex:16,yindex:4,imgResolutionx:3780,imgResolutiony:1415,img:"Font"};function randomBool(e,t){return 1==random(1,2)?e:t}function random(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function randomFloat(e,t){return parseFloat(Math.random()*(t-e)+e).toFixed(3)}function randomizeArray(e){for(var t=0;t<e.length;t++){var a=random(0,e.length-1),n=e[a],o=e[t];e[t]=n,e[a]=o}return e}function checkIntersection(e,t){return!(e.x>=t.x+t.width||e.x+e.width<=t.x||e.y>=t.y+t.height||e.y+e.height<=t.y)}function checkCircleIntersection(e,t){var a=e.x+e.width/2,n=e.y+e.height/2,i=t.x+t.width/2,o=t.y+t.height/2;return!!((e.width+t.width)/2>Math.sqrt((i-a)*(i-a)+(o-n)*(o-n)))}